---
title: "Midcourse Project Data Cleanup and Plots"
output: html_document
date: "2023-01-04"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
library(tidyr)
library(readr)
library(ggplot2)
library(treemapify)
```


```{r}
prices <- read_csv("2022_pub_dates_1_04_2023.csv")
prices <- prices %>% 
  rename(List_Price_Value = 'List Price Value')
```


```{r}
prices$List_Price_Value <- as.numeric(sub("\\$", "", prices$List_Price_Value))
prices <- prices %>% 
  filter(Pages != "Not Specified")
prices$Pages <- as.numeric(prices$Pages)
```


```{r}
p <- prices %>% 
  filter(Format == 'Hardcover' & Subcategory == 'SOCIAL SCIENCE - ANF')

p %>% 
    ggplot(aes(x = List_Price_Value)) + 
    geom_histogram(color = 1, fill = 'skyblue', bins = 50) + 
    geom_vline(xintercept = median(p$List_Price_Value, na.rm = TRUE), 
             linetype="dotted", 
             color = 'red',
             lwd = 2) + 
    annotate("text",
           x = median(p$List_Price_Value, na.rm = TRUE) * 1.9,
           y = median(p$List_Price_Value, na.rm = TRUE) * 1.9,
           label = paste("Median =", median(p$List_Price_Value, na.rm = TRUE)),
           color = "red",
           size = 5) +
  labs(x = 'List Price ($)', y = 'Frequency') +
  labs(title = "List Price Distribution")
```
```{r}
prices %>% 
  filter(Format == 'Trade Paperback' & Subcategory == 'HISTORY - ANF') %>% 
  ggplot(aes(area = Sales_2022, fill = BISAC_Level_1, label = BISAC_Level_1, subgroup = BISAC_Level_1, layout = 'squarified')) + geom_treemap()
```

